**Comprehensive Static and Dynamic Analysis of an Incransom Ransomware Sample: Behavior, Persistence, and Threat Intelligence<br>**

**Project Type**: Malware Analysis · SOC Fundamentals <br>
**Tools:** FlareVM, INetSim <br>
**Date**: December 25, 2025 <br>

**Analyst**: Aisha B. Bello <br>

**Confidentiality Notice:**

This project is a simulation of a Static and Dynamic Malware Analysis as part of a SOC investigation scenario. All precausions were taken to execute this project. The findings of this project are based on controlled lab data and are used strictly for educational and portfolio purposes.<br>
    ![Executable](Screenshots/Mal1.png)

**Executive Summary**<br>

Modern ransomware campaigns continue to evolve, adopting stealthier execution methods and abusing legitimate system components to evade detection. This ransomware has been operating since July, 2023, with a focus on targeting healthcare, education and technology sectors. This malware analysis documents a comprehensive static and dynamic analysis of a Windows-based ransomware sample identified as Incransom — a sophisticated malware that encrypts user data affecting the core cybersecurity CIA triad. What makes this ransomware dangerous is its ability to use Living-off-The-Land techniques and double extortion.<br>

**Key Findings from Malware Investigation**:<br>
•	**Malware Family**: INC Ransomware (Ransoware)<br>
•	**Primary Target:** User-data encryption and extortion<br>
•	**Evasion Techniques**: Process masquerading<br>
•	**Persistence: Modified** Startup registry key<br>

**Malware Sample Acquisition** <br>

The malware sample was obtained from MalwareBazaar, a reputable malware repository to ensure authenticity and research relevance. The sample was downloaded as a zip file, with its known hash value to avoid accidental acquisition of an incorrect or modified file.<br>

**STATIC ANALYSIS OF INCRANSOM RANSOMWARE** <br>
The malware embedded in the zip file was extracted for static malware analysis (windows.exe)<br>
1. **Malware Information** <br>
The windows.exe file was examined to determine its hash, format and operating system compatibility using tools Powershell, HxD and HashCalc <br>
**Findings**: <br>
•	**Hash SHA256:** 834C5F094C4A2DB0F520962341B108AF685EFD346E5B6622EB2331B3FFA09039<br>
•	**File Header**: MZ_ 4D 5A<br>
•	**File type**: windows.exe, Portable Executable — PE32<br>
•**Architecture**: Intel 80386<br>
•	**Subsystem:** Console<br>
    ![Execute](Screenshots/Mal2.png)
    ![Execute](Screenshots/Mal4.png)


**2.** **Entropy & Packing Analysis** <br>
Entropy analysis using PEStudio and Detect It Easy (DIE) revealed: <br>
•	**Entropy Score**: 6.712<br>
•	**Packing Level**: ~83%<br>
•	**Packed Section:** .text<br>

The presence of **crypt32.dll** suggests the malware leverages Windows cryptographic APIs for encryption routines. While not fully obfuscated, the packing indicates deliberate attempts to hinder static analysis. 
    ![Execute](Screenshots/Mal5.png)

3. String analysis (PE studio and Floss)<br>
**Key observations include**:<br>
•	References to Safe Boot modification and shadow copy deletion, indicating ransomware persistence mechanisms.<br>
•	Abuse of legitimate Windows libraries:<br>
**CRYPT32.dll** — encryption and cryptographic operations<br>
**MPR.dll** — network share enumeration and access<br>
•	**FLOSS**-extracted strings revealed command-line arguments consistent with ransomware execution logic. 
    ![Execute](Screenshots/Mal6.PNG)
    ![Execute](Screenshots/Mal7.PNG)
    ![Execute](Screenshots/Mal8.png)

**Threat Intelligence Correlation (VirusTotal)** <br>

**Malware Hash**: SHA256- 834c5f094c4a2db0f520962341b108af685efd346e5b6622eb2331b3ffa09039<br>

**1. Detection Ratio:** A total of 64/72 security vendors flagged this malware as malicious with a 90% Anti-Virus detection rate.
    ![execute](Screenshots/Mal9.png)

**2. Identification of Hash and Metadata** <br>
•	**Hash**: SHA-256: 834C5F094C4A2DB0F520962341B108AF685EFD346E5B6622EB2331B3FFA09039<br>
•	**File Type**: Windows Portable Executable (PE32)<br>
•	**File Names**: windows.exe , 834c.exe,834c5f094c4a2db0f520962341b108af685efd346e5b6622eb2331b3ffa09039.exe<br>
•	**Architecture**: Intel 80386 <br>
•	**Subsystem:** Console <br>
•	**Magic Bytes**: 4D 5A (MZ)<br>
•	**Family labels**: incransom; imps: raninc <br>
•	**File Size**: 161.50 KB (165376 bytes) <br>
•	**Date of Creation**: The malware was first created in 2024–04–09 <br>

**3. Behavioral Indicator**s <br>
**Execution Context** <br>
The malware was delivered as ZIP archive named WINDOWS.ZIP, a common social engineering tactic used to disguise malicious content as legitimate system files. Once extracted and executed, the malware initiated its infection chain.<br>

**Detection Summary**: <br>
•	**Detection rate**: 56/67 engines <br>
•	**Execution context**: User-assisted execution via compressed archive<br>
•	**Behavioral tags:**checks-cpu-name , checks-usb-bus , checks-user-input , crypto<br>
These behaviors indicate environmental awareness, often used to evade sandboxes and automated analysis systems.<br>

**4. Network Behavior Analysis** <br>
**Outbound Communications**. <br>
The malware initiated outbound HTTP requests using the Microsoft-CryptoAPI/6.1 user-agent, a tactic used to masquerade malicious traffic as legitimate system communication.<br>

**Contacted Domains** <br>
•	crt.sectigo.com<br>
•	sectigo.com<br>
•	microsoft.com<br>
•	www.microsoft.com<br>
Although some of these domains are legitimate, their use in this context is deceptive. The malware accessed certificate-related URLs to blend malicious traffic with trusted network flows.
    ![Execute](Screenshots/Mal10.png)

**Contacted IP Addresses** <br>
•	23.216.81.152 <br>
•	20.99.133.109 <br>
Both IPs are associated with U.S.-based infrastructure and were used to facilitate outbound communications.
    ![Execute](Screenshots/Mal11.png)

**URL Patterns and Indicators** <br>
All observed URLs followed a .crt structure and returned HTTP 200 responses, suggesting successful connections. These patterns strongly indicate: <br>
•	Command-and-control beaconing <br>
•	System fingerprinting< br>
•	Covert data exchange under the guise of certificate retrieval<br>
    ![Execute](Screenshots/Mal12.png)

**5. File System Activity** <br>

**5.1 File Creation and Modification** <br>
The malware extensively interacted with the filesystem, creating and modifying files in sensitive directories. Notable behaviors include: <br>
•	Writing ransom-related files such as INC-README.html and INC-README.txt across root and system-level directories. <br>
•	Accessing and modifying files within: <br>
•	C:\$Recycle.Bin\ <br>
•	C:\MSOCache\All Users\ <br>
These actions suggest deliberate attempts to blend malicious artifacts into trusted system locations while preparing ransom notifications.<br>
    ![Execute](Screenshots/Mal13.png)

**6. Registry Activity** <br>

The malware accessed several registry locations, particularly: <br>
**_HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer_** <br>
**_HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User_** Shell Folders <br>

These keys reveal user directory structures and allow the malware to identify high-value locations such as Desktop, Documents, and AppData. This behavior strongly supports reconnaissance and persistence preparation. <br>
    ![Execute](Screenshots/Mal4.png)

**7. Process and Execution Behavior** <br>

**7.1 Process Creation** <br>
**Key processes involved include**: <br>
•	_**software.exe**_ – This is the initial dropper placed on the user’s Desktop which was used to manually launched the file, and trigger the ransomware infection. <br>
•	_**%SAMPLEPATH%\834c5f094c4...exe**_ – This is the main ransomware payload, stored in a temporary directory. <br>
•	**_FXSSVC.exe_** – Abused to blend malicious activity <br>
•	**_conhost.exe_** – Forced execution to suppress console logging <br>
    ![Execute](Screenshots/Mal15.png)

**7.2 Process Injection** <br>

The malware injected code into WMIADAP.EXE, a trusted Windows Management Instrumentation process. This technique allows the malware to operate under a legitimate system process, significantly reducing detection likelihood. <br>

**7.3 Process Termination** <br>
To maintain control and avoid interference, the malware terminated several system processes, including: <br>
•	_**svchost.exe**_ – disabling error reporting <br>
•	_**wmiadap.exe**_ – enabling code injection <br>
•	_**conhost.exe**_ – hiding command-line execution <br>
•	_**sihost.exe**_ – suppressing UI refresh <br>
•	_**software.exe**_ – terminating the initial dropper post-execution <br>
This coordinated process manipulation highlights a mature ransomware design focused on stealth, persistence, and operational reliability.<br>
    ![Execute](Screenshots/Mal16.png)


**INDICATORS OF COMPROMISE** <br>
    ![Execute](Screenshots/Mal17.png)

**MITRE ATT&CK MAPPING** <br>
    ![Execute](Screenshots/Mal18.png)

**Dynamic Analysis of Incransom Ransomware** <br>

To observe the real-time behavior of the Incransom ransomware, a dynamic analysis was conducted using Regshot and Process Monitor (Procmon). An initial system snapshot was taken before execution, followed by a second snapshot after running the malware with administrative privileges. This allowed for precise identification of system and registry modifications caused by the sample.<br>

**Registry Activity Analysis** <br>

The comparison revealed clear evidence of successful malware execution. Registry entries confirmed that the malicious binary (windows.exe) was executed directly from the user’s Desktop directory. 

Notably, artifacts were written under: <br>
_**HKLM\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Compatibility Assistant\Store\C:\Users\TISH\Desktop\windows.exe**_ <br>
This registry path is commonly used by Windows to track application execution history. Its presence confirms that the operating system recognized and logged the execution of the suspicious binary, validating successful compromise. <br>
    ![Execute](Screenshots/Mal19.png)
    ![Execute](Screenshots/Mal20.png)

**Process Activity and Execution Flow** <br>

Process Monitor analysis showed that the malicious executable (windows.exe) spawned conhost.exe, a legitimate Windows Console Host process. This behavior indicates that the malware leveraged command-line execution to perform its tasks, a common tactic used to evade user suspicion and security controls. <br>
The use of a misleading filename (windows.exe) further demonstrates a masquerading technique designed to trick users into believing the file is a legitimate system component. This parent–child relationship between windows.exe and conhost.exe provides high-confidence evidence of active malware execution and post-compromise activity. <br>
    ![Execute](Screenshots/Mal21.png)

**Key Takeaways** <br>
•	Incransom is a highly capable ransomware variant that combines encryption, persistence, and stealth techniques to maintain long-term control over infected systems.<br>
•	The malware heavily abuses legitimate Windows components (such as WMI, conhost.exe, and cryptographic libraries) to evade detection and blend into normal system activity.<br>
•	Static and dynamic analysis together revealed its full behavior, showing that relying on signature-based detection alone would be insufficient.<br>
•	The use of trusted domains and certificate-based traffic allows the malware to disguise command-and-control communication as legitimate system activity.<br>
•	Process injection and termination of security services demonstrate a deliberate effort to disable defenses and maintain operational dominance.<br>
•	The ransomware follows a structured attack lifecycle, from delivery and execution to persistence, data encryption, and cleanup — indicating a professionally developed threat.<br>

**SUMMARY** <br>

The malware sample, delivered as a compressed ZIP file, contained a Windows Portable Executable masquerading as a legitimate system binary. Static analysis confirmed it as a 32-bit PE file compiled for Windows environments, with indicators of packing and encrypted content. String analysis revealed strong ransomware characteristics, including references to shadow copy deletion, cryptographic libraries, and network resource enumeration. <br>

Threat intelligence correlation using VirusTotal classified the sample as Ransomware.Incransom, with a high detection rate across multiple security engines. The malware demonstrated sophisticated behavior such as masquerading as legitimate Windows processes, abusing WMI for execution, and communicating with external servers under the guise of legitimate certificate validation traffic.<br>

Dynamic analysis further revealed aggressive system manipulation. The ransomware created and modified files across system directories, deployed ransom notes, terminated protective processes, and injected itself into trusted Windows services. Registry modifications confirmed execution persistence and environment reconnaissance. Network traffic analysis showed outbound connections mimicking certificate validation traffic — an effective evasion technique commonly observed in advanced ransomware campaigns. <br>

CONCLUSION<br>

The malware sample represents a fully functional and dangerous ransomware strain. Its use of trusted Windows processes, strategic process injection, registry manipulation, and encrypted communications demonstrates a mature threat actor capable of bypassing traditional security controls.<br>

This analysis confirms that the malware is designed to achieve persistence, disable recovery mechanisms, encrypt user data, and maintain stealth throughout its execution lifecycle. The observed behaviors align with known ransomware tactics, techniques, and procedures (TTPs) mapped to the MITRE ATT&CK framework.<br>

From a defensive standpoint, this case highlights the critical need for layered security controls, proactive monitoring, and rapid incident response capabilities. Organizations must enforce strict execution policies, maintain updated detection signatures, and educate users on phishing and malicious file delivery to mitigate the risk posed by threats of this nature.<br>

**RECOMMENDATIONS** <br>

1.	Strengthen Endpoint Protection<br>
Deploy advanced EDR solutions capable of detecting process injection, abnormal parent-child relationships, and suspicious WMI activity. <br>

2. Restrict Script and Binary Execution<br>
Implement application control policies (AppLocker or WDAC) to prevent unauthorized executables from running, especially from user-writable directories.<br>

**3. Enhance Network Monitoring** <br>
Monitor outbound traffic for anomalous certificate requests and suspicious .crt-based HTTP activity often associated with C2 communication.<br>

**4. User Awareness and Email Security** <br>
Educate users on phishing and malicious attachments, as the initial infection vector relies heavily on user interaction.<br> 

**5. Regular Backups and Recovery Testing** <br>
Maintain offline and immutable backups to ensure recovery capability in the event of ransomware execution.<br>

**6. Threat Intelligence Integration** <br>
Continuously ingest and correlate IOC feeds (hashes, domains, IPs) into SIEM and SOC workflows to improve early detection and response.<br>

**Overall Perspective**: <br>
Modern malware increasingly abuses legitimate processes, creating a problem for security teams. Blocking these processes isn’t feasible because they required components for running windows operating systems. This case underscores why layered defense, behavioral analysis, and proactive threat hunting are no longer optional but essential.










