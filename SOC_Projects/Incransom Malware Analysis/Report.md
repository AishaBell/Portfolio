**Comprehensive Static and Dynamic Analysis of an Incransom Ransomware Sample: Behavior, Persistence, and Threat Intelligence<br>**

<br>
Project Type: Malware Analysis · SOC Fundamentals<br>
Tools: FlareVM, INetSim<br>
Date: December 25, 2025<br>
<br>
<br>
Analyst: Aisha Bello<br>

**Confidentiality Notice:**

This project is a simulation of a Static and Dynamic Malware Analysis as part of a SOC investigation scenario. All precausions were taken to execute this project. The findings of this project are based on controlled lab data and are used strictly for educational and portfolio purposes.<br>
    ![Executable](Screenshots/Mal1.png)

**Executive Summary**<br>

Modern ransomware campaigns continue to evolve, adopting stealthier execution methods and abusing legitimate system components to evade detection. This ransomware has been operating since July, 2023, with a focus on targeting healthcare, education and technology sectors. This malware analysis documents a comprehensive static and dynamic analysis of a Windows-based ransomware sample identified as Incransom — a sophisticated malware that encrypts user data affecting the core cybersecurity CIA triad. What makes this ransomware dangerous is its ability to use Living-off-The-Land techniques and double extortion.<br>

**Key Findings from Malware Investigation:**<br>
•	**Malware Family**: INC Ransomware (Ransoware)<br>
•	**Primary Target:** User-data encryption and extortion<br>
•	**Evasion Techniques**: Process masquerading<br>
•	**Persistence: Modified** Startup registry key<br>

**Malware Sample Acquisition**<br>

The malware sample was obtained from MalwareBazaar, a reputable malware repository to ensure authenticity and research relevance. The sample was downloaded as a zip file, with its known hash value to avoid accidental acquisition of an incorrect or modified file.<br>

**STATIC ANALYSIS OF INCRANSOM RANSOMWARE**<br>
The malware embedded in the zip file was extracted for static malware analysis (windows.exe)<br>
1. **Malware Information**<br>
The windows.exe file was examined to determine its hash, format and operating system compatibility using tools Powershell, HxD and HashCalc<br>
**Findings**:<br>
•	**Hash SHA256:** 834C5F094C4A2DB0F520962341B108AF685EFD346E5B6622EB2331B3FFA09039<br>
•	**File Header**: MZ_ 4D 5A<br>
•	**File type**: windows.exe, Portable Executable — PE32<br>
•**Architecture**: Intel 80386<br>
•	**Subsystem:** Console<br>
    ![Execute](Screenshots/Mal2.png)
    ![Execute](Screenshots/Mal4.png)


2. **Entropy & Packing Analysis**<br>
Entropy analysis using PEStudio and Detect It Easy (DIE) revealed:<br>
•	**Entropy Score**: 6.712<br>
•	**Packing Level**: ~83%<br>
•	**Packed Section:** .text<br>

The presence of **crypt32.dll** suggests the malware leverages Windows cryptographic APIs for encryption routines. While not fully obfuscated, the packing indicates deliberate attempts to hinder static analysis. 
    ![Execute](Screenshots/Mal5.png)

3. **String analysis (PE studio and Floss)**<br>
**Key observations include**:<br>
•	References to Safe Boot modification and shadow copy deletion, indicating ransomware persistence mechanisms.<br>
•	Abuse of legitimate Windows libraries:<br>
**CRYPT32.dll** — encryption and cryptographic operations<br>
**MPR.dll** — network share enumeration and access<br>
•	**FLOSS**-extracted strings revealed command-line arguments consistent with ransomware execution logic. 
    ![Execute](Screenshots/Mal6.PNG)
    ![Execute](Screenshots/Mal7.PNG)
    ![Execute](Screenshots/Mal8.png)

**Threat Intelligence Correlation (VirusTotal)**<br>

Malware Hash: SHA256- 834c5f094c4a2db0f520962341b108af685efd346e5b6622eb2331b3ffa09039<br>

1. Detection Ratio: A total of 64/72 security vendors flagged this malware as malicious with a 90% Anti-Virus detection rate.
    ![execute](Screenshots/Mal9.png)

2. Identification of Hash and Metadata<br>
•	Hash: SHA-256: 834C5F094C4A2DB0F520962341B108AF685EFD346E5B6622EB2331B3FFA09039<br>
•	File Type: Windows Portable Executable (PE32)<br>
•	File Names: windows.exe , 834c.exe , 834c5f094c4a2db0f520962341b108af685efd346e5b6622eb2331b3ffa09039.exe<br>
•	Architecture: Intel 80386<br>
•	Subsystem: Console<br>
•	Magic Bytes: 4D 5A (MZ)<br>
•	Family labels: incransom; imps: raninc<br>
•	File Size: 161.50 KB (165376 bytes)<br>
•	Date of Creation: The malware was first created in 2024–04–09<br>

3. Behavioral Indicators<br>
Execution Context<br>
The malware was delivered as ZIP archive named WINDOWS.ZIP, a common social engineering tactic used to disguise malicious content as legitimate system files. Once extracted and executed, the malware initiated its infection chain.<br>

Detection Summary:<br>
•	Detection rate: 56/67 engines<br>
•	Execution context: User-assisted execution via compressed archive<br>
•	Behavioral tags:checks-cpu-name , checks-usb-bus , checks-user-input , crypto<br>
These behaviors indicate environmental awareness, often used to evade sandboxes and automated analysis systems.<br>

4. Network Behavior Analysis<br>
Outbound Communications. <br>
The malware initiated outbound HTTP requests using the Microsoft-CryptoAPI/6.1 user-agent, a tactic used to masquerade malicious traffic as legitimate system communication.<br>

Contacted Domains<br>
•	crt.sectigo.com<br>
•	sectigo.com<br>
•	microsoft.com<br>
•	www.microsoft.com<br>
Although some of these domains are legitimate, their use in this context is deceptive. The malware accessed certificate-related URLs to blend malicious traffic with trusted network flows.
    ![Execute](Screenshots/Mal10.png)

Contacted IP Addresses<br>
•	23.216.81.152<br>
•	20.99.133.109<br>
Both IPs are associated with U.S.-based infrastructure and were used to facilitate outbound communications.
    ![Execute](Screenshots/Mal11.png)

URL Patterns and Indicators<br>
All observed URLs followed a .crt structure and returned HTTP 200 responses, suggesting successful connections. These patterns strongly indicate:<br>
•	Command-and-control beaconing<br>
•	System fingerprinting<br>
•	Covert data exchange under the guise of certificate retrieval<br>
    ![Execute](Screenshots/Mal12.png)

5. File System Activity<br>

5.1 File Creation and Modification<br>
The malware extensively interacted with the filesystem, creating and modifying files in sensitive directories. Notable behaviors include:<br>
•	Writing ransom-related files such as INC-README.html and INC-README.txt across root and system-level directories.<br>
•	Accessing and modifying files within:<br>
•	C:\$Recycle.Bin\<br>
•	C:\MSOCache\All Users\<br>
These actions suggest deliberate attempts to blend malicious artifacts into trusted system locations while preparing ransom notifications.<br>
    ![Execute](Screenshots/Mal13.png)

6. Registry Activity<br>

The malware accessed several registry locations, particularly:<br>
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer<br>
HKCU\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders<br>

These keys reveal user directory structures and allow the malware to identify high-value locations such as Desktop, Documents, and AppData. This behavior strongly supports reconnaissance and persistence preparation.<br>
    ![Execute](Screenshots/Mal4.png)

7. Process and Execution Behavior<br>

7.1 Process Creation<br>
Key processes involved include:<br>
•	software.exe – This is the initial dropper placed on the user’s Desktop which was used to manually launched the file, and trigger the ransomware infection.<br>
•	%SAMPLEPATH%\834c5f094c4...exe – This is the main ransomware payload, stored in a temporary directory.<br>
•	FXSSVC.exe – Abused to blend malicious activity<br>
•	conhost.exe – Forced execution to suppress console logging<br>
    ![Execute](Screenshots/Mal15.png)











